------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  C:\Users\gauta\Documents\GitHub\pandemic\pandemic.log
  log type:  text
 opened on:  19 Sep 2021, 12:53:21

. 
. *Analysis 1: Regressing GHSI_Overall on stock_1/stock_WHO2 (daily stock data from Investing.com). (12/09/21)
. use "./Data/pandemic.dta", clear

. 
end of do-file

. do "C:\Users\gauta\AppData\Local\Temp\STD6098_000000.tmp"

. use "./Data/pandemic.dta", clear

. 
end of do-file

. do "C:\Users\gauta\AppData\Local\Temp\STD6098_000000.tmp"

. use "./Data/pandemic.dta", clear

. keep Country dstr_WHO GHSI_Overall 

. 
end of do-file

. do "C:\Users\gauta\AppData\Local\Temp\STD6098_000000.tmp"

. use "./Data/pandemic.dta", clear

. 
end of do-file

. do "C:\Users\gauta\AppData\Local\Temp\STD6098_000000.tmp"

. clear

. cd "C:/Users/gauta/Documents/GitHub/pandemic/Data"
C:\Users\gauta\Documents\GitHub\pandemic\Data

. 
. //GHSI DATA (X1a)
. import excel "./GHSI_2019_data.xlsx", sheet("Sheet2") firstrow clear
(20 vars, 196 obs)

. drop J K L M N O P Q R S T U

. 
. rename Overall GHSI_Overall

. rename D GHSI_prev

. rename E GHSI_det

. rename F GHSI_resp

. rename G GHSI_hea_sec

. rename H GHSI_commit

. rename I GHSI_risk

. 
. save ghsi.dta, replace
file ghsi.dta saved

. 
. *here - when working with other potential explanatorys, create a master X file
. 
. //looking for outliers/inspecting data
. sum 

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     Country |          0
GHSI_Overall |        196        40.2    14.47817       16.2       83.5
   GHSI_prev |        196     34.7551    16.87089        1.9       83.1
    GHSI_det |        196    41.88469    23.75211        2.7       98.2
   GHSI_resp |        196    38.43418    15.08093       11.3       91.9
-------------+---------------------------------------------------------
GHSI_hea_sec |        196    26.42755    16.83055         .3       73.8
 GHSI_commit |        196    48.48469    12.60972       23.3       85.3
   GHSI_risk |        196    55.03112    16.16126       15.9       87.9

. inspect 

Country:  Country                               Number of Observations
-----------------                      ---------------------------------------
                                             Total      Integers   Nonintegers
|                            Negative            -             -             -
|                            Zero                -             -             -
|                            Positive            -             -             -
|                                      -----------   -----------   -----------
|                            Total               -             -             -
|                            Missing           196
+----------------------                -----------
.             -9.0e+307                        196
   (0 unique value)

GHSI_Overall:  Overall                          Number of Observations
----------------------                 ---------------------------------------
                                             Total      Integers   Nonintegers
|      #                     Negative            -             -             -
|      #                     Zero                -             -             -
|  #   #                     Positive          196            23           173
|  #   #   #                           -----------   -----------   -----------
|  #   #   #                 Total             196            23           173
|  #   #   #   #   .         Missing             -
+----------------------                -----------
16.2               83.5                        196
(More than 99 unique values)

GHSI_prev:  1                                   Number of Observations
-------------                          ---------------------------------------
                                             Total      Integers   Nonintegers
|      #                     Negative            -             -             -
|      #                     Zero                -             -             -
|      #                     Positive          196            30           166
|      #   #                           -----------   -----------   -----------
|  #   #   #                 Total             196            30           166
|  #   #   #   #   .         Missing             -
+----------------------                -----------
1.9                83.1                        196
(More than 99 unique values)

GHSI_det:  2                                    Number of Observations
------------                           ---------------------------------------
                                             Total      Integers   Nonintegers
|      #                     Negative            -             -             -
|      #   #                 Zero                -             -             -
|  #   #   #                 Positive          196            28           168
|  #   #   #   #                       -----------   -----------   -----------
|  #   #   #   #             Total             196            28           168
|  #   #   #   #   #         Missing             -
+----------------------                -----------
2.7                98.2                        196
(More than 99 unique values)

GHSI_resp:  3                                   Number of Observations
-------------                          ---------------------------------------
                                             Total      Integers   Nonintegers
|      #                     Negative            -             -             -
|      #                     Zero                -             -             -
|  #   #   #                 Positive          196            18           178
|  #   #   #                           -----------   -----------   -----------
|  #   #   #                 Total             196            18           178
|  #   #   #   #   .         Missing             -
+----------------------                -----------
11.3               91.9                        196
(More than 99 unique values)

GHSI_hea_sec:  4                                Number of Observations
----------------                       ---------------------------------------
                                             Total      Integers   Nonintegers
|  #                         Negative            -             -             -
|  #   #                     Zero                -             -             -
|  #   #                     Positive          196            24           172
|  #   #   #                           -----------   -----------   -----------
|  #   #   #   #             Total             196            24           172
|  #   #   #   #   #         Missing             -
+----------------------                -----------
.3                 73.8                        196
(More than 99 unique values)

GHSI_commit:  5                                 Number of Observations
---------------                        ---------------------------------------
                                             Total      Integers   Nonintegers
|          #                 Negative            -             -             -
|      #   #                 Zero                -             -             -
|      #   #                 Positive          196            22           174
|  #   #   #                           -----------   -----------   -----------
|  #   #   #   #             Total             196            22           174
|  #   #   #   #   .         Missing             -
+----------------------                -----------
23.3               85.3                        196
(More than 99 unique values)

GHSI_risk:  6                                   Number of Observations
-------------                          ---------------------------------------
                                             Total      Integers   Nonintegers
|          #                 Negative            -             -             -
|          #                 Zero                -             -             -
|      #   #   #             Positive          196            21           175
|      #   #   #                       -----------   -----------   -----------
|      #   #   #   #         Total             196            21           175
|  #   #   #   #   #         Missing             -
+----------------------                -----------
15.9               87.9                        196
(More than 99 unique values)

. 
. //STOCK MARKET DATA (Y)
. 
. *stock market data from Investing.com
. import excel "./stockdata/stockfluctuations_1.xlsx", firstrow clear
(7 vars, 195 obs)

. save inv_fluctuations.dta, replace
file inv_fluctuations.dta saved

. 
. *Datastream data - For Loop generating % change between 06/03 and 13/03
. import excel "./stockdata/DataStream/data/stock_ts.xlsx", sheet(Table1) firstrow clear
(24 vars, 22 obs)

. 
. *generating WHO crash - can adjust this for loop in the future to generate % drop in week of first case, etc. 
. keep Country K L

. foreach i in Country {
  2.         gen dstr_WHO = ((L - K)/K)
  3.         }

. 
. drop K L

. save dtsr_fluctuations.dta, replace
file dtsr_fluctuations.dta saved

. 
. *saving master stock fluctuations file
. merge 1:1 Country using inv_fluctuations.dta
(note: variable Country was str14, now str29 to accommodate using data's values)

    Result                           # of obs.
    -----------------------------------------
    not matched                           175
        from master                         1  (_merge==1)
        from using                        174  (_merge==2)

    matched                                21  (_merge==3)
    -----------------------------------------

. drop if _merge !=3
(175 observations deleted)

. drop _merge

. save master_fluctuations.dta, replace
file master_fluctuations.dta saved

. 
. *merging master stock and GHSI data
. merge 1:1 Country using ghsi.dta

    Result                           # of obs.
    -----------------------------------------
    not matched                           175
        from master                         0  (_merge==1)
        from using                        175  (_merge==2)

    matched                                21  (_merge==3)
    -----------------------------------------

. drop if _merge !=3
(175 observations deleted)

. drop _merge

. save pandemic.dta, replace
file pandemic.dta saved

. 
. 
. 
. 
. 
. 
. 
. 
. 
. 
. 
. 
. 
. 
. 
. 
. 
. 
. 
. 
. //only downloaded/merged x and y thus far, for a subsample of countries. No control variables yet.
. 
. //todo: download subsample of stock market data when the pandemic hit. 
.         //first, download time series stock market excel sheets for Jan/Feb/March/April each country. Have this dataset available (so that we can edit the lags if needed in next step) - DONE
.                 //then cut in STATA - for each country, 4 variables: stock market performance on the day it hit, 1 week, 2 weeks and 1 month after. Dates: https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7068164/
.                         //then merge into GHSI data.
.         
.         //pandemic timeline: do a variable of stock returns following: WHO pandemic announcement (11th March) + 2 day and 1 week lags. For lags - do average of daily fluctuations or? Probably. Could do sum of variation (don't think this would have an
>  effect).
.         //then also do 1st case in country + lags.
.         
. //regression: % change_i = a + bGHSI_i + u_i. No control variables yet; dependent variable varies depending on dates.
. 
end of do-file

. do "C:\Users\gauta\AppData\Local\Temp\STD6098_000000.tmp"

. keep Country dstr_WHO GHSI_Overall 

. 
end of do-file

. do "C:\Users\gauta\AppData\Local\Temp\STD6098_000000.tmp"

. scatter dstr_WHO GHSI_Overall

. 
end of do-file

. do "C:\Users\gauta\AppData\Local\Temp\STD6098_000000.tmp"

. 
. asdoc reg dstr_WHO GHSI_Overall, robust replace

Linear regression                               Number of obs     =         21
                                                F(1, 19)          =       0.09
                                                Prob > F          =     0.7725
                                                R-squared         =     0.0073
                                                Root MSE          =     .05683

------------------------------------------------------------------------------
             |               Robust
    dstr_WHO |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
GHSI_Overall |   .0004447   .0015162     0.29   0.772    -.0027288    .0036182
       _cons |  -.1555736    .099264    -1.57   0.134    -.3633356    .0521884
------------------------------------------------------------------------------
(note: file Myfile.doc not found)
Click to Open File:  Myfile.doc

. 
end of do-file

. do "C:\Users\gauta\AppData\Local\Temp\STD6098_000000.tmp"

. scatter dstr_WHO GHSI_Overall

. 
end of do-file

. do "C:\Users\gauta\AppData\Local\Temp\STD6098_000000.tmp"

. asdoc reg dstr_WHO GHSI_Overall, robust replace dec(5)

Linear regression                               Number of obs     =         21
                                                F(1, 19)          =       0.09
                                                Prob > F          =     0.7725
                                                R-squared         =     0.0073
                                                Root MSE          =     .05683

------------------------------------------------------------------------------
             |               Robust
    dstr_WHO |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
GHSI_Overall |   .0004447   .0015162     0.29   0.772    -.0027288    .0036182
       _cons |  -.1555736    .099264    -1.57   0.134    -.3633356    .0521884
------------------------------------------------------------------------------
(note: file Myfile.doc not found)
Click to Open File:  Myfile.doc

. 
end of do-file

. exit, clear
